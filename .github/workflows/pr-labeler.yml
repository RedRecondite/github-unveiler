name: PR Labeler

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  label:
    name: Label PR
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Label based on changed files
      uses: actions/labeler@v5
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}

  validate-pr:
    name: Validate PR
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Check PR title
      run: |
        PR_TITLE="${{ github.event.pull_request.title }}"
        echo "PR Title: $PR_TITLE"

        # Check if PR title is meaningful (not too short)
        if [ ${#PR_TITLE} -lt 10 ]; then
          echo "PR title is too short. Please provide a more descriptive title."
          exit 1
        fi

        echo "PR title is valid"

    - name: Check for description
      run: |
        PR_BODY="${{ github.event.pull_request.body }}"

        if [ -z "$PR_BODY" ] || [ ${#PR_BODY} -lt 20 ]; then
          echo "Warning: PR description is empty or too short. Consider adding more details."
          echo "This is just a warning and won't fail the check."
        else
          echo "PR has a description"
        fi
